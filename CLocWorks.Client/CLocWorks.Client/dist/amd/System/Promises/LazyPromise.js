/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT
 */
var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define(["require","exports","./Promise","../Threading/defer","../Exceptions/ArgumentNullException"],function(t,e,n,o,r){"use strict";var i=void 0,s=function(t){function e(e){if(t.call(this),this._resolver=e,!e)throw new r.ArgumentNullException("resolver");this._resolvedCalled=!0}return __extends(e,t),e.prototype._onDispose=function(){t.prototype._onDispose.call(this),this._resolver=i},e.prototype._onThen=function(){var t=this._resolver;t&&(this._resolver=i,this._resolvedCalled=!1,this.resolveUsing(t))},e.prototype.thenSynchronous=function(e,n){return this._onThen(),t.prototype.thenSynchronous.call(this,e,n)},e.prototype.thenThis=function(e,n){return this._onThen(),t.prototype.thenThis.call(this,e,n)},e.prototype.delayFromNow=function(n){var r=this;if(void 0===n&&(n=0),this.throwIfDisposed(),!this._resolver||this.isSettled)return t.prototype.delayFromNow.call(this,n);var i,s=!1,u=o.defer(function(){s=!0,i&&i()},n);return new e(function(t,e){i=function(){r.thenThis(function(e){return t(e)},function(t){return e(t)}),u.dispose(),u=null,i=null},s&&i()})},e.prototype.delayAfterResolve=function(n){var r=this;if(void 0===n&&(n=0),this.throwIfDisposed(),!this._resolver||this.isSettled)return t.prototype.delayAfterResolve.call(this,n);var i,s,u=function(){s&&(s.dispose(),s=null),i&&i(),u=null},l=function(){u&&(s=o.defer(u,n))};return t.prototype.thenThis.call(this,l,l),l=null,new e(function(t,e){r.isPending?(r.thenThis(function(e){return o.defer(function(){return t(e)},n)},function(t){return o.defer(function(){return e(t)},n)}),u()):(i=function(){r.thenThis(function(e){return t(e)},function(t){return e(t)})},u||i())})},e}(n.Promise);e.LazyPromise=s,Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=s});
//# sourceMappingURL=LazyPromise.js.map
