/*!
 * @author electricessence / https://github.com/electricessence/
 * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md
 */
var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};define(["require","exports","./Enumeration/Enumerator","../Compare","../Exceptions/ArgumentNullException","../Exceptions/InvalidOperationException","../Disposable/DisposableBase","../Types"],function(t,e,i,o,n,r,a,s){"use strict";var u="CollectionBase",p="Cannot modify a disposed collection.",d="Cannot modify a read-only collection.",l="resolve",c="../../System.Linq/Linq",f=function(e){function a(t,i){void 0===i&&(i=o.areEqual),e.call(this),this._equalityComparer=i;var n=this;n._disposableObjectName=u,n._importEntries(t),n._updateRecursion=0,n._modifiedCount=0,n._version=0}return __extends(a,e),Object.defineProperty(a.prototype,"count",{get:function(){return this.getCount()},enumerable:!0,configurable:!0}),a.prototype.getIsReadOnly=function(){return!1},Object.defineProperty(a.prototype,"isReadOnly",{get:function(){return this.getIsReadOnly()},enumerable:!0,configurable:!0}),a.prototype.assertModifiable=function(){if(this.throwIfDisposed(p),this.getIsReadOnly())throw new r.InvalidOperationException(d)},a.prototype.assertVersion=function(t){if(t!=this._version)throw new r.InvalidOperationException("Collection was modified.")},a.prototype._onModified=function(){},a.prototype._signalModification=function(t){var e=this;if(t&&e._modifiedCount++,e._modifiedCount&&!this._updateRecursion){e._modifiedCount=0,e._version++;try{e._onModified()}catch(i){console.error(i)}return!0}return!1},a.prototype._incrementModified=function(){this._modifiedCount++},Object.defineProperty(a.prototype,"isUpdating",{get:function(){return 0!=this._updateRecursion},enumerable:!0,configurable:!0}),a.prototype.handleUpdate=function(t){if(!t)return!1;var e=this;e.assertModifiable(),e._updateRecursion++;var i=!1;try{(i=t())&&e._modifiedCount++}finally{e._updateRecursion--}return e._signalModification(),i},a.prototype.add=function(t){var e=this;e.assertModifiable(),e._updateRecursion++;try{e._addInternal(t)&&e._modifiedCount++}finally{e._updateRecursion--}e._signalModification()},a.prototype.remove=function(t,e){void 0===e&&(e=1/0);var i=this;i.assertModifiable(),i._updateRecursion++;var o;try{(o=i._removeInternal(t,e))&&i._modifiedCount++}finally{i._updateRecursion--}return i._signalModification(),o},a.prototype.clear=function(){var t=this;t.assertModifiable(),t._updateRecursion++;var e;try{(e=t._clearInternal())&&t._modifiedCount++}finally{t._updateRecursion--}return t._signalModification(),e},a.prototype._onDispose=function(){e.prototype._onDispose.call(this),this._clearInternal(),this._version=0,this._updateRecursion=0,this._modifiedCount=0;var t=this._linq;this._linq=null,t&&t.dispose()},a.prototype._importEntries=function(t){var e=this,o=0;if(t)if(Array.isArray(t))for(var n=0,r=t;n<r.length;n++){var a=r[n];this._addInternal(a)&&o++}else i.forEach(t,function(t){e._addInternal(t)&&o++});return o},a.prototype.importEntries=function(t){var e=this;e.assertModifiable(),e._updateRecursion++;var i;try{(i=e._importEntries(t))&&e._modifiedCount++}finally{e._updateRecursion--}return e._signalModification(),i},a.prototype.contains=function(t){if(!this.getCount())return!1;var e=!1,i=this._equalityComparer;return this.forEach(function(o){return!(e=i(t,o))}),e},a.prototype.forEach=function(t,e){if(!e)return i.forEach(this.getEnumerator(),t);var o=this.toArray();try{return i.forEach(o,t)}finally{o.length=0}},a.prototype.copyTo=function(t,e){if(void 0===e&&(e=0),!t)throw new n.ArgumentNullException("target");var i=this.getCount(),o=i+e;t.length<o&&(t.length=o);for(var r=this.getEnumerator();r.moveNext();)t[e++]=r.current;return t},a.prototype.toArray=function(){var t=this.getCount();return this.copyTo(t>65536?new Array(t):[])},Object.defineProperty(a.prototype,"linq",{get:function(){if(s.Type.hasMember(t,l)&&1==t.length){var e=this._linq;return e||(this._linq=e=t(c)["default"].from(this)),e}throw".linq currently only supported within CommonJS.\nImport System.Linq/Linq and use Enumerable.from(e) instead."},enumerable:!0,configurable:!0}),a}(a.DisposableBase);e.CollectionBase=f});
//# sourceMappingURL=CollectionBase.js.map
